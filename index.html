<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>ESP32 Sensor Dashboard</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 40px;
    }
    h2 {
      text-align: center;
    }
    .chart-container {
      width: 100%;
      max-width: 800px;
      margin: 50px auto;
    }
  </style>
</head>
<body>
  <h2>ESP32 Sensor Dashboard</h2>

  <div class="chart-container">
    <canvas id="tempChart"></canvas>
  </div>
  <div class="chart-container">
    <canvas id="humidityChart"></canvas>
  </div>
  <div class="chart-container">
    <canvas id="mq2Chart"></canvas>
  </div>
  <div class="chart-container">
    <canvas id="mq4Chart"></canvas>
  </div>
  <div class="chart-container">
    <canvas id="mq5Chart"></canvas>
  </div>
  <div class="chart-container">
    <canvas id="mq7Chart"></canvas>
  </div>
  <div class="chart-container">
    <canvas id="mq8Chart"></canvas>
  </div>
  <div class="chart-container">
    <canvas id="mq9Chart"></canvas>
  </div>

  <script>
    const channelID = 'YOUR_CHANNEL_ID'; // Replace with your ThingSpeak Channel ID
    const readAPIKey = 'YOUR_READ_API_KEY'; // Replace with your ThingSpeak Read API Key if the channel is private

    const fields = [
      { id: 1, name: 'Temperature (Â°C)', canvasId: 'tempChart', color: 'rgba(255, 99, 132, 1)' },
      { id: 2, name: 'Humidity (%)', canvasId: 'humidityChart', color: 'rgba(54, 162, 235, 1)' },
      { id: 3, name: 'MQ2', canvasId: 'mq2Chart', color: 'rgba(255, 206, 86, 1)' },
      { id: 4, name: 'MQ4', canvasId: 'mq4Chart', color: 'rgba(75, 192, 192, 1)' },
      { id: 5, name: 'MQ5', canvasId: 'mq5Chart', color: 'rgba(153, 102, 255, 1)' },
      { id: 6, name: 'MQ7', canvasId: 'mq7Chart', color: 'rgba(255, 159, 64, 1)' },
      { id: 7, name: 'MQ8', canvasId: 'mq8Chart', color: 'rgba(199, 199, 199, 1)' },
      { id: 8, name: 'MQ9', canvasId: 'mq9Chart', color: 'rgba(83, 102, 255, 1)' }
    ];

    fields.forEach(field => {
      fetchDataAndRenderChart(field);
    });

    function fetchDataAndRenderChart(field) {
      const url = `https://api.thingspeak.com/channels/${channelID}/fields/${field.id}.json?results=60&api_key=${readAPIKey}`;
      fetch(url)
        .then(response => response.json())
        .then(data => {
          const labels = data.feeds.map(feed => new Date(feed.created_at).toLocaleTimeString());
          const values = data.feeds.map(feed => parseFloat(feed[`field${field.id}`]));

          const ctx = document.getElementById(field.canvasId).getContext('2d');
          new Chart(ctx, {
            type: 'line',
            data: {
              labels: labels,
              datasets: [{
                label: field.name,
                data: values,
                borderColor: field.color,
                backgroundColor: 'rgba(0, 0, 0, 0)',
                borderWidth: 2,
                pointRadius: 2
              }]
            },
            options: {
              responsive: true,
              scales: {
                x: {
                  display: true,
                  title: {
                    display: true,
                    text: 'Time'
                  }
                },
                y: {
                  display: true,
                  title: {
                    display: true,
                    text: field.name
                  }
                }
              }
            }
          });
        })
        .catch(error => {
          console.error(`Error fetching data for ${field.name}:`, error);
        });
    }
  </script>
</body>
</html>
